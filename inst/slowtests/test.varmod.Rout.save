> # test.varmod.R
> 
> library(earth)
Loading required package: plotmo
Loading required package: plotrix
> options(warn=2)
> expect.err <- function(obj) # test that we got an error as expected from a try() call
+ {
+     if(class(obj)[1] == "try-error")
+         cat("Got error as expected\n")
+     else
+         stop("did not get expected try error")
+ }
> printh <- function(caption)
+     cat("===", caption, "\n", sep="")
> 
> CAPTION <- NULL
> 
> multifigure <- function(caption, nrow=3, ncol=3)
+ {
+     CAPTION <<- caption
+     printh(caption)
+     par(mfrow=c(nrow, ncol))
+     par(cex = 0.8)
+     par(mar = c(3, 3, 5, 0.5)) # small margins but space for right hand axis
+     par(mgp = c(1.6, 0.6, 0))  # flatten axis elements
+     oma <- par("oma") # make space for caption
+     oma[3] <- 2
+     par(oma=oma)
+ }
> do.caption <- function() # must be called _after_ first plot on new page
+     mtext(CAPTION, outer=TRUE, font=2, line=1, cex=1)
> if(!interactive())
+     postscript(paper="letter")
> old.par <- par(no.readonly=TRUE)
> 
> multifigure("test predict.earth with pints", 2, 2)
===test predict.earth with pints
> 
> set.seed(2)
> earth.trees <- earth(Volume~Girth, data=trees, nfold=3, ncross=3, varmod.method="earth")
> 
> printh("print.default(earth.trees$varmod)")
===print.default(earth.trees$varmod)
> print.default(earth.trees$varmod)
$call
varmod(parent = parent, method = method, exponent = exponent, 
    conv = conv, clamp = clamp, minspan = minspan, trace = trace, 
    parent.x = x, parent.y = y, model.var = model.var, degree = ..1)

$parent
Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145    RSS 309.6832    GRSq 0.949137    RSq 0.9617962

$method
[1] "earth"

$exponent
[1] 1

$lambda
[1] 1

$converged
[1] TRUE

$iters
[1] 1

$residmod
Selected 2 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: RHS
Number of terms at each degree of interaction: 1 1 (additive model)
GCV 3.4882    RSS 88.2177    GRSq 0.2106366    RSq 0.3123768

$min.sd
[1] 0.3800377

$model.var
              [,1]
 [1,] 0.4237080282
 [2,] 0.9796261257
 [3,] 0.3353434600
 [4,] 0.0014690631
 [5,] 0.1956131647
 [6,] 0.1656436269
 [7,] 0.4260785739
 [8,] 0.1660133056
 [9,] 0.1308601982
[10,] 0.4700957111
[11,] 0.0001419694
[12,] 0.1660851055
[13,] 0.5168044702
[14,] 0.2612776068
[15,] 0.2310163116
[16,] 0.5379486915
[17,] 1.6295066790
[18,] 0.4264025111
[19,] 0.0090402313
[20,] 0.0305532477
[21,] 1.2162723789
[22,] 1.7221628721
[23,] 1.5223938207
[24,] 0.1820720480
[25,] 0.2350058950
[26,] 0.3501834397
[27,] 2.7639280510
[28,] 2.5209256938
[29,] 3.8249680345
[30,] 0.2403475621
[31,] 9.1817721531

$abs.resids
         Volume
 [1,] 0.7975990
 [2,] 1.2429614
 [3,] 1.7509813
 [4,] 1.1484398
 [5,] 0.8405929
 [6,] 1.3783014
 [7,] 3.9078464
 [8,] 1.1225815
 [9,] 3.3502387
[10,] 0.6873876
[11,] 4.3101763
[12,] 0.6411992
[13,] 1.1719193
[14,] 0.5870355
[15,] 3.7951596
[16,] 3.8635479
[17,] 8.9363279
[18,] 0.7564978
[19,] 3.0376093
[20,] 4.3294863
[21,] 5.0370789
[22,] 1.3549887
[23,] 3.4526918
[24,] 5.3635770
[25,] 2.8631420
[26,] 4.0604341
[27,] 3.3523508
[28,] 3.3190359
[29,] 5.8240248
[30,] 6.0695913
[31,] 5.6473173

$parent.x
      Girth
 [1,]   8.3
 [2,]   8.6
 [3,]   8.8
 [4,]  10.5
 [5,]  10.7
 [6,]  10.8
 [7,]  11.0
 [8,]  11.0
 [9,]  11.1
[10,]  11.2
[11,]  11.3
[12,]  11.4
[13,]  11.4
[14,]  11.7
[15,]  12.0
[16,]  12.9
[17,]  12.9
[18,]  13.3
[19,]  13.7
[20,]  13.8
[21,]  14.0
[22,]  14.2
[23,]  14.5
[24,]  16.0
[25,]  16.3
[26,]  17.3
[27,]  17.5
[28,]  17.9
[29,]  18.0
[30,]  18.0
[31,]  20.6

$parent.y
      Volume
 [1,]   10.3
 [2,]   10.3
 [3,]   10.2
 [4,]   16.4
 [5,]   18.8
 [6,]   19.7
 [7,]   15.6
 [8,]   18.2
 [9,]   22.6
[10,]   19.9
[11,]   24.2
[12,]   21.0
[13,]   21.4
[14,]   21.3
[15,]   19.1
[16,]   22.2
[17,]   33.8
[18,]   27.4
[19,]   25.7
[20,]   24.9
[21,]   34.5
[22,]   31.7
[23,]   36.3
[24,]   38.3
[25,]   42.6
[26,]   55.4
[27,]   55.7
[28,]   58.3
[29,]   51.5
[30,]   51.0
[31,]   77.0

$iter.rsq
[1] 0.3123768

$iter.stderr
              (Intercept) residmod$bxh(25.6817-RHS) 
               0.40081837                0.06710405 

attr(,"class")
[1] "varmod"
> 
> printh("summary(earth.trees)")
===summary(earth.trees)
> print(summary(earth.trees))
Call: earth(formula=Volume~Girth, data=trees, ncross=3, nfold=3, 
      varmod.method="earth")

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9451125

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.95 0.017        9.8 7.5

varmod: method "earth"    min.sd 0.38    iter.rsq 0.312

stddev of predictions:
                  coefficients iter.stderr iter.stderr%
(Intercept)          4.9378880    0.502351           10
h(25.6817-Volume)   -0.3052613   0.0841025           28

                              mean   smallest    largest      ratio
95% prediction interval   14.92951    1.48972   19.35617   12.99315

                                         68%    80%    90%    95% 
response values in prediction interval   71     90     97     97  
> 
> # level arg not allowed with interval="se"
> expect.err(try(predict(earth.trees, interval="se", level=.8)))
Error : predict.varmod: the level argument is not allowed with type="se"
Got error as expected
> 
> printh("predict(earth.trees, interval=\"se\")")
===predict(earth.trees, interval="se")
> stderrs <- predict(earth.trees, interval="se")
> print(stderrs)
 [1] 0.3800377 0.4384742 0.6477493 2.4265873 2.6358624 2.7404999 2.9497750
 [8] 2.9497750 3.0544125 3.1590500 3.2636876 3.3683251 3.3683251 3.6822377
[15] 3.9961503 4.9378880 4.9378880 4.9378880 4.9378880 4.9378880 4.9378880
[22] 4.9378880 4.9378880 4.9378880 4.9378880 4.9378880 4.9378880 4.9378880
[29] 4.9378880 4.9378880 4.9378880
> 
> # level arg not allowed with interval="abs.residual"
> expect.err(try(predict(earth.trees, interval="abs.res", level=.8)))
Error : predict.varmod: the level argument is not allowed with type="abs.residual"
Got error as expected
> 
> printh("predict(earth.trees, interval=\"abs.residual\")")
===predict(earth.trees, interval="abs.residual")
> stderrs <- predict(earth.trees, interval="abs.residual")
> print(stderrs)
 [1] 0.3032262 0.3498518 0.5168292 1.9361365 2.1031139 2.1866026 2.3535799
 [8] 2.3535799 2.4370686 2.5205572 2.6040459 2.6875346 2.6875346 2.9380006
[15] 3.1884666 3.9398646 3.9398646 3.9398646 3.9398646 3.9398646 3.9398646
[22] 3.9398646 3.9398646 3.9398646 3.9398646 3.9398646 3.9398646 3.9398646
[29] 3.9398646 3.9398646 3.9398646
> 
> expect.err(try(predict(earth.trees, newdata=trees, interval="cint")))
Error : predict.varmod: newdata is not allowed with interval="cint"
Got error as expected
> 
> printh("predict(earth.trees, interval=\"cint\")")
===predict(earth.trees, interval="cint")
> cints <- predict(earth.trees, interval="cint")
> print(cints)
         fit       lwr      upr
1   9.913855  8.638058 11.18965
2  10.942195  9.002300 12.88209
3  11.627755 10.492763 12.76275
4  17.455018 17.379896 17.53014
5  18.140578 17.273722 19.00743
6  18.483359 17.685666 19.28105
7  19.168919 17.889558 20.44828
8  19.168919 18.370337 19.96750
9  19.511699 18.802690 20.22071
10 19.854479 18.510659 21.19830
11 20.197259 20.173906 20.22061
12 20.540040 19.741285 21.33879
13 20.540040 19.131039 21.94904
14 21.568380 20.566538 22.57022
15 22.596721 21.654680 23.53876
16 25.681742 24.244207 27.11928
17 25.681742 23.179806 28.18368
18 27.052863 25.773016 28.33271
19 28.423983 28.237630 28.61034
20 28.766764 28.424172 29.10936
21 30.080913 27.919372 32.24245
22 31.395063 28.822978 33.96715
23 33.366287 30.947979 35.78459
24 43.222408 42.386093 44.05872
25 45.193632 44.243492 46.14377
26 51.764379 50.604545 52.92421
27 53.078529 49.820076 56.33698
28 55.706828 52.594910 58.81875
29 56.363903 52.530698 60.19711
30 56.363903 55.403025 57.32478
31 73.447846 67.508873 79.38682
> 
> printh("predict(earth.trees, interval=\"pin\", level=.80)")
===predict(earth.trees, interval="pin", level=.80)
> news <- predict(earth.trees, interval="pin", level=.80)
> print(news)
         fit       lwr      upr
1   9.913855  9.426817 10.40089
2  10.942195 10.380268 11.50412
3  11.627755 10.797631 12.45788
4  17.455018 14.345221 20.56481
5  18.140578 14.762585 21.51857
6  18.483359 14.971267 21.99545
7  19.168919 15.388630 22.94921
8  19.168919 15.388630 22.94921
9  19.511699 15.597312 23.42609
10 19.854479 15.805994 23.90296
11 20.197259 16.014676 24.37984
12 20.540040 16.223357 24.85672
13 20.540040 16.223357 24.85672
14 21.568380 16.849403 26.28736
15 22.596721 17.475448 27.71799
16 25.681742 19.353584 32.00990
17 25.681742 19.353584 32.00990
18 27.052863 20.724705 33.38102
19 28.423983 22.095825 34.75214
20 28.766764 22.438605 35.09492
21 30.080913 23.752755 36.40907
22 31.395063 25.066904 37.72322
23 33.366287 27.038129 39.69444
24 43.222408 36.894250 49.55057
25 45.193632 38.865474 51.52179
26 51.764379 45.436221 58.09254
27 53.078529 46.750371 59.40669
28 55.706828 49.378670 62.03499
29 56.363903 50.035745 62.69206
30 56.363903 50.035745 62.69206
31 73.447846 67.119688 79.77600
> 
> printh("print.default(earth.trees$varmod$residmod)")
===print.default(earth.trees$varmod$residmod)
> # have to modify earth.trees because terms field stores the environment
> # as a hex address which messes up the diffs
> earth.trees$varmod$residmod$terms <- NULL
> print.default(earth.trees$varmod$residmod)
$bx
      (Intercept) h(25.6817-RHS)
 [1,]           1      15.767888
 [2,]           1      14.739547
 [3,]           1      14.053987
 [4,]           1       8.226724
 [5,]           1       7.541164
 [6,]           1       7.198383
 [7,]           1       6.512823
 [8,]           1       6.512823
 [9,]           1       6.170043
[10,]           1       5.827263
[11,]           1       5.484483
[12,]           1       5.141702
[13,]           1       5.141702
[14,]           1       4.113362
[15,]           1       3.085021
[16,]           1       0.000000
[17,]           1       0.000000
[18,]           1       0.000000
[19,]           1       0.000000
[20,]           1       0.000000
[21,]           1       0.000000
[22,]           1       0.000000
[23,]           1       0.000000
[24,]           1       0.000000
[25,]           1       0.000000
[26,]           1       0.000000
[27,]           1       0.000000
[28,]           1       0.000000
[29,]           1       0.000000
[30,]           1       0.000000
[31,]           1       0.000000

$dirs
               RHS
(Intercept)      0
h(RHS-25.6817)   1
h(25.6817-RHS)  -1
h(RHS-43.2224)   1

$cuts
                    RHS
(Intercept)     0.00000
h(RHS-25.6817) 25.68174
h(25.6817-RHS) 25.68174
h(RHS-43.2224) 43.22241

$selected.terms
[1] 1 3

$prune.terms
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    1    3    0    0
[3,]    1    3    4    0
[4,]    1    2    3    4

$rss
[1] 88.2177

$rsq
[1] 0.3123768

$gcv
[1] 3.4882

$grsq
[1] 0.2106366

$rss.per.response
[1] 88.2177

$rsq.per.response
[1] 0.3123768

$gcv.per.response
[1] 3.4882

$grsq.per.response
[1] 0.2106366

$rss.per.subset
[1] 128.29366  88.21770  81.31999  81.22837

$gcv.per.subset
[1] 4.419004 3.488200 3.729171 4.371666

$rss.per.subset
[1] 128.29366  88.21770  81.31999  81.22837

$gcv.per.subset
[1] 4.419004 3.488200 3.729171 4.371666

$fitted.values
      abs.resids
 [1,] 0.09938581
 [2,] 0.34985182
 [3,] 0.51682916
 [4,] 1.93613655
 [5,] 2.10311389
 [6,] 2.18660256
 [7,] 2.35357990
 [8,] 2.35357990
 [9,] 2.43706857
[10,] 2.52055724
[11,] 2.60404591
[12,] 2.68753458
[13,] 2.68753458
[14,] 2.93800059
[15,] 3.18846660
[16,] 3.93986463
[17,] 3.93986463
[18,] 3.93986463
[19,] 3.93986463
[20,] 3.93986463
[21,] 3.93986463
[22,] 3.93986463
[23,] 3.93986463
[24,] 3.93986463
[25,] 3.93986463
[26,] 3.93986463
[27,] 3.93986463
[28,] 3.93986463
[29,] 3.93986463
[30,] 3.93986463
[31,] 3.93986463

$residuals
       abs.resids
 [1,]  0.69821318
 [2,]  0.89310955
 [3,]  1.23415211
 [4,] -0.78769675
 [5,] -1.26252101
 [6,] -0.80830120
 [7,]  1.55426655
 [8,] -1.23099838
 [9,]  0.91317016
[10,] -1.83316966
[11,]  1.70613040
[12,] -2.04633535
[13,] -1.51561531
[14,] -2.35096508
[15,]  0.60669298
[16,] -0.07631673
[17,]  4.99646323
[18,] -3.18336680
[19,] -0.90225532
[20,]  0.38962172
[21,]  1.09721426
[22,] -2.58487588
[23,] -0.48717284
[24,]  1.42371239
[25,] -1.07672265
[26,]  0.12056947
[27,] -0.58751387
[28,] -0.62082874
[29,]  1.88416021
[30,]  2.12972668
[31,]  1.70745270

$coefficients
               abs.resids
(Intercept)     3.9398646
h(25.6817-RHS) -0.2435633

$leverages
 [1] 0.24689453 0.21180022 0.19014329 0.06223841 0.05380006 0.05010267
 [7] 0.04375147 0.04375147 0.04109766 0.03879170 0.03683360 0.03522336
[13] 0.03522336 0.03247977 0.03286691 0.05281259 0.05281259 0.05281259
[19] 0.05281259 0.05281259 0.05281259 0.05281259 0.05281259 0.05281259
[25] 0.05281259 0.05281259 0.05281259 0.05281259 0.05281259 0.05281259
[31] 0.05281259

$penalty
[1] 2

$nk
[1] 21

$thresh
[1] 0.001

$termcond
[1] 4

$weights
NULL

$namesx.org
[1] "RHS"

$namesx
[1] "RHS"

$call
earth(formula = abs.resids ~ ., data = data, weights = weights, 
    keepxy = TRUE, trace = trace, minspan = minspan, degree = ..1)

$data
   abs.resids       RHS
1   0.7975990  9.913855
2   1.2429614 10.942195
3   1.7509813 11.627755
4   1.1484398 17.455018
5   0.8405929 18.140578
6   1.3783014 18.483359
7   3.9078464 19.168919
8   1.1225815 19.168919
9   3.3502387 19.511699
10  0.6873876 19.854479
11  4.3101763 20.197259
12  0.6411992 20.540040
13  1.1719193 20.540040
14  0.5870355 21.568380
15  3.7951596 22.596721
16  3.8635479 25.681742
17  8.9363279 25.681742
18  0.7564978 27.052863
19  3.0376093 28.423983
20  4.3294863 28.766764
21  5.0370789 30.080913
22  1.3549887 31.395063
23  3.4526918 33.366287
24  5.3635770 43.222408
25  2.8631420 45.193632
26  4.0604341 51.764379
27  3.3523508 53.078529
28  3.3190359 55.706828
29  5.8240248 56.363903
30  6.0695913 56.363903
31  5.6473173 73.447846

$y
      abs.resids
 [1,]  0.7975990
 [2,]  1.2429614
 [3,]  1.7509813
 [4,]  1.1484398
 [5,]  0.8405929
 [6,]  1.3783014
 [7,]  3.9078464
 [8,]  1.1225815
 [9,]  3.3502387
[10,]  0.6873876
[11,]  4.3101763
[12,]  0.6411992
[13,]  1.1719193
[14,]  0.5870355
[15,]  3.7951596
[16,]  3.8635479
[17,]  8.9363279
[18,]  0.7564978
[19,]  3.0376093
[20,]  4.3294863
[21,]  5.0370789
[22,]  1.3549887
[23,]  3.4526918
[24,]  5.3635770
[25,]  2.8631420
[26,]  4.0604341
[27,]  3.3523508
[28,]  3.3190359
[29,]  5.8240248
[30,]  6.0695913
[31,]  5.6473173

attr(,"class")
[1] "earth"
> # prevent mistakes later where we try to use a modified earth.trees
> remove(earth.trees)
> 
> multifigure("test example for varmod help page", 2, 2)
===test example for varmod help page
> 
> data(ozone1)
> set.seed(1) # optional, for cross validation reproducibility
> 
> a <- earth(O3~temp, data=ozone1, nfold=10, ncross=3, varmod.method="earth")
> 
> print(summary(a)) # note additional info on the variance model
Call: earth(formula=O3~temp, data=ozone1, ncross=3, nfold=10, 
      varmod.method="earth")

            coefficients
(Intercept)    7.5768304
h(58-temp)    -0.1572930
h(temp-58)     0.6090229

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: temp
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 22.43818  RSS 7181.917  GRSq 0.6514492  RSq 0.6598731  CVRSq 0.6218799

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.10 sd 0.31    nvars 1.00 sd 0.00

     CVRSq  sd     MaxErr sd
      0.62 0.1         17 11

varmod: method "earth"    min.sd 0.458    iter.rsq 0.155

stddev of predictions:
              coefficients iter.stderr iter.stderr%
(Intercept)      6.4593452    0.308376            5
h(16.1032-O3)   -0.3346135   0.0431316           13

                             mean   smallest    largest      ratio
95% prediction interval   17.9375    7.32813   25.32017   3.455202

                                         68%    80%    90%    95% 
response values in prediction interval   70     82     94     97  
> 
> old.mfrow <- par(mfrow=c(2,2))
> 
> # the variance model assumes residuals are symmetric, which is not
> # quite true in this example, so the lower band is a bit too big
> plotmo(a, do.par=FALSE, col.response=1, level=.95, main="earth model: O3~temp")
> 
> plot(a, which=1)            # model selection plot, same as ever
> plot(a, which=3, level=.95) # residual plot: note 95% pred and darker conf intervals
> plot(a, which=3, level=.95, student=TRUE) # student resids are approx homoscedastic
> 
> par(par=old.mfrow)
> 
> plot(a$varmod)              # plot the embedded variance model (this calls plot.varmod)
> 
> multifigure("test example for plot.varmod help page", 2, 2)
===test example for plot.varmod help page
> 
> # multivariate example (for univariate, see the example on the varmod help page)
> 
> data(ozone1)
> set.seed(1) # optional, for cross validation reproducibility
> 
> mod.temp.vh.doy <- earth(O3~temp+vh+vis+doy, data=ozone1, nfold=5, ncross=3, varmod.method="x.earth")
> 
> print(summary(mod.temp.vh.doy))  # note additional info on the variance model
Call: earth(formula=O3~temp+vh+vis+doy, data=ozone1, ncross=3, 
      nfold=5, varmod.method="x.earth")

            coefficients
(Intercept)    5.2163722
h(temp-58)     0.4187634
h(vh-5540)     0.0209890
h(200-vis)     0.0284138
h(106-doy)    -0.1080735
h(doy-106)    -0.0257969

Selected 6 of 13 terms, and 4 of 4 predictors 
Termination condition: RSq changed by less than 0.001 at 13 terms
Importance: temp, vis, doy, vh
Number of terms at each degree of interaction: 1 5 (additive model)
GCV 17.82264  RSS 5495.907  GRSq 0.7231463  RSq 0.7397205  CVRSq 0.6819337

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 7.27 sd 1.03    nvars 4.00 sd 0.00

     CVRSq    sd     MaxErr sd
      0.68 0.042        -17 14

varmod: method "x.earth"    min.sd 0.416    iter.rsq 0.245

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)    8.1090033      1.3236           16
h(vh-5690)     0.0139750   0.0026345           19
h(vis-70)     -0.0233887   0.0057574           25
h(vis-150)     0.0255409   0.0086142           34
h(doy-119)    -0.0207916   0.0059022           28
h(302-doy)    -0.0199895    0.006164           31

                              mean   smallest   largest      ratio
95% prediction interval   16.30346   3.098773   31.2156   10.07354

                                         68%    80%    90%    95% 
response values in prediction interval   71     83     93     96  
> 
> plot(mod.temp.vh.doy, level=.95) # note 95% pred and darker conf intervals in resids plot
> 
> plot(mod.temp.vh.doy$varmod)     # plot the variance model (this calls plot.varmod)
> 
> plot(mod.temp.vh.doy, versus="", level=.9, caption="plot.earth versus=\"\"")
> 
> plot(mod.temp.vh.doy, versus="v", level=.9, caption="plot.earth versus=\"v\" and versus=\"temp\"", do.par=2)
> plot(mod.temp.vh.doy, versus="temp", level=.9, caption="", main="temp on same page")
> 
> # plot.earth will silently not plots it cannot plot below, so 1:9 becomes c(3,5,6)
> plot(mod.temp.vh.doy, which=1:9, versus="v", info=T, caption='which=c(3,5) versus="v" info=T')
> 
> # versus="*"
> 
> plot(mod.temp.vh.doy, versus="*", level=.9,
+      caption="plot.earth versus=\"*\"")
> 
> # versus="*" and versus=1:4 with info
> 
> plot(mod.temp.vh.doy, versus="*", level=.8, info=TRUE,
+      caption="plot.earth versus=\"*\" with info")
> 
> multifigure("versus=1:4", 3, 3)
===versus=1:4
> 
> plot(mod.temp.vh.doy, versus=1, caption="", do.par=FALSE, which=3)
> do.caption()
> plot(mod.temp.vh.doy, versus=2, caption="", do.par=FALSE)
> plot(mod.temp.vh.doy, versus=3, caption="", do.par=FALSE)
> 
> plot(mod.temp.vh.doy, versus=1, info=TRUE, caption="", do.par=FALSE, which=3)
> plot(mod.temp.vh.doy, versus=2, info=TRUE, caption="", do.par=FALSE)
> plot(mod.temp.vh.doy, versus=3, info=TRUE, caption="", do.par=FALSE)
> 
> plot(mod.temp.vh.doy, versus=1, info=TRUE, caption="", do.par=FALSE, level=.8, which=3)
> plot(mod.temp.vh.doy, versus=2, info=TRUE, caption="", do.par=FALSE, level=.8)
> plot(mod.temp.vh.doy, versus=3, info=TRUE, caption="", do.par=FALSE, level=.8)
> 
> expect.err(try(plot(mod.temp.vh.doy, versus=9)))
Error : versus must be an integer or a string:
  1    fitted (default)
  2    obs numbers
  3    response
  4    leverages
  "*"  earth terms
  ""   predictors
Got error as expected
> expect.err(try(plot(mod.temp.vh.doy, versus=1.2)))
Error : versus must be an integer or a string:
  1    fitted (default)
  2    obs numbers
  3    response
  4    leverages
  "*"  earth terms
  ""   predictors
Got error as expected
> expect.err(try(plot(mod.temp.vh.doy, versus=2:3)))
Error : illegal versus (length of versus must be 1 when versus is numeric)
Got error as expected
> 
> # versus="*doy"
> 
> plot(mod.temp.vh.doy, versus="*doy", level=.9, caption="plot.earth versus=\"*doy\"")
> 
> # test warnings from plotmor about which
> options(warn=1) # print warnings as they occur
> plot(mod.temp.vh.doy, which=1, versus="*doy")
Warning: the "which" argument is empty after removing certain plots because "versus" was specified
Warning: plot.earth: nothing to plot
> options(warn=2)
> 
> multifigure("test example in (very old) earth vignette", 2, 2)
===test example in (very old) earth vignette
> 
> data(ozone1)
> x <- ozone1$temp
> y <- ozone1$O3
> 
> set.seed(1) # optional, for cross validation reproducibility
> earth.mod <- earth(y~x, nfold=10, ncross=3, varmod.method="earth", trace=.1)
> predict <- predict(earth.mod, interval="pint")
> 
> order <- order(x)
> x <- x[order]
> y <- y[order]
> predict <- predict[order,]
> 
> inconf <- y >= predict$lwr & y <= predict$upr
> 
> plot(x, y, pch=20, col=ifelse(inconf, 1, 2), main=sprintf(
+     "Prediction intervals\n%.0f%% of the points are in the estimated band",
+     100 * sum(inconf) / length(y)))
> do.caption()
> 
> lines(x, predict$fit)
> lines(x, predict$lwr, lty=2)
> lines(x, predict$upr, lty=2)
> 
> # Plot the Residuals vs Fitted graph
> plot(earth.mod, which=3, level=.95)
> 
> # Plot the embedded residual model
> plot(earth.mod$varmod, do.par=F, which=1:2)
> 
> cat('head(residuals(earth.mod))\n')
head(residuals(earth.mod))
> print(head(residuals(earth.mod)))
           y
1 -1.7455563
2 -0.5320213
3 -1.9476584
4  2.0409087
5 -1.5320213
6 -3.1049514
> cat('head(residuals(earth.mod, type="student"))\n')
head(residuals(earth.mod, type="student"))
> print(head(residuals(earth.mod, type="student")))
           y
1 -0.6615450
2 -0.1828061
3 -0.5752632
4  0.8634842
5 -0.5264128
6 -0.9033688
> 
> multifigure("plot.earth varmod options", 2, 2)
===plot.earth varmod options
> 
> plot(earth.mod, which=3, level=.95, shade.pints=0, main="plot.earth varmod options")
> do.caption()
> plot(earth.mod, which=3, shade.pints="orange", shade.cints="darkgray", level=.99)
> plot(earth.mod, which=3, level=.95, shade.pints=0, shade.cints="mistyrose4")
> 
> multifigure("plot.earth delever and student", 2, 2)
===plot.earth delever and student
> 
> set.seed(4)
> earth.mod1 <- earth(O3~temp, data=ozone1, nfold=5, ncross=3, varmod.method="lm", keepxy=T, trace=.1)
> plot(earth.mod1, which=3, ylim=c(-16,20), info=TRUE, level=.95)
> do.caption()
> plot(earth.mod1, which=3, ylim=c(-16,20), delever=TRUE, level=.95)
> plot(earth.mod1, which=3, student=TRUE, info=TRUE,    level=.95)
> # the student and delever arguments cannot both be set
> expect.err(try(plot(earth.mod1, which=3, student=TRUE, delever=TRUE, level=.95)))
Error : the student and delever arguments cannot both be set
Got error as expected
> 
> multifigure("plot.earth which=5 and which=6", 2, 3)
===plot.earth which=5 and which=6
> plot(earth.mod1, which=5, info=T,            main="which=5, info=T")
> plot(earth.mod1, which=5, student=T, info=T, main="which=5, student=T, info=T")
> plot(earth.mod1, which=5, student=T,         main="which=5, student=T")
> do.caption()
> plot(earth.mod1, which=6, info=T,            main="which=6, info=T")
> plot(earth.mod1, which=6, student=T, info=T, main="which=6, student=T, info=T")
> plot(earth.mod1, which=6, student=T,         main="which=6, student=T")
> 
> multifigure("plot.earth which=7", 2, 3)
===plot.earth which=7
> plot(earth.mod1, which=7, info=T,            main="which=7, info=T")
> plot(earth.mod1, which=7, student=T, info=T, main="which=7, student=T, info=T")
> plot(earth.mod1, which=7, student=T,         main="which=7, student=T")
> do.caption()
> 
> multifigure("plot.earth which=8 and which=9", 2, 3)
===plot.earth which=8 and which=9
> plot(earth.mod1, which=8, info=T,            main="which=8, info=T")
> plot(earth.mod1, which=8, student=T, info=T, main="which=8, student=T, info=T")
> plot(earth.mod1, which=8, student=T,         main="which=8, student=T")
> do.caption()
> plot(earth.mod1, which=9, info=T,            main="which=9, info=T")
> plot(earth.mod1, which=9, student=T, info=T, main="which=9, student=T, info=T")
> plot(earth.mod1, which=9, student=T,         main="which=9, student=T")
> 
> multifigure("plot.earth versus=4, which=3 and which=5", 2, 3)
===plot.earth versus=4, which=3 and which=5
> plot(earth.mod1, versus=4, which=3,                    main="versus=4, which=3")
> plot(earth.mod1, versus=4, which=3, student=T, info=T, main="versus=4, which=3, student=T, info=T")
> plot(earth.mod1, versus=4, which=3, student=T,         main="versus=4, which=3, student=T")
> do.caption()
> plot(earth.mod1, versus=4, which=5,                    main="versus=4, which=5")
> plot(earth.mod1, versus=4, which=5, student=T, info=T, main="versus=4, which=5, student=T, info=T")
> plot(earth.mod1, versus=4, which=5, student=T,         main="versus=4, which=5, student=T")
> 
> cat("summary(earth.mod1, newdata=ozone1)\n")
summary(earth.mod1, newdata=ozone1)
> print(summary(earth.mod1, newdata=ozone1))

RSq 0.660 on newdata (330 cases)

                                 68%    80%    90%    95% 
newdata in prediction interval   70     82     92     97  
> 
> cat("summary(earth.mod1, newdata=ozone1[1:100,]:)\n")
summary(earth.mod1, newdata=ozone1[1:100,]:)
> print(summary(earth.mod1, newdata=ozone1[1:100,]))

RSq 0.199 on newdata (100 cases)

                                 68%    80%    90%    95% 
newdata in prediction interval   76     84     91     95  
> 
> # earth.default
> O3 <- ozone1$O3
> temp <- ozone1$temp
> set.seed(4)
> earth.default <- earth(temp, O3, nfold=5, ncross=3, varmod.method="lm")
> cat("summary(earth.default)\n")
summary(earth.default)
> print(summary(earth.default))
Call: earth(x=temp, y=O3, ncross=3, nfold=5, varmod.method="lm")

            coefficients
(Intercept)    7.5768304
h(58-temp)    -0.1572930
h(temp-58)     0.6090229

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: temp
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 22.43818  RSS 7181.917  GRSq 0.6514492  RSq 0.6598731  CVRSq 0.6309346

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.07 sd 0.59    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr sd
      0.63 0.071         17 14

varmod: method "lm"    min.sd 0.47    iter.rsq 0.147

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)    1.5170251    0.337577           22
O3             0.2702271   0.0359131           13

                              mean   smallest    largest      ratio
95% prediction interval   18.42034    8.47422   36.55175   4.313288

                                         68%    80%    90%    95% 
response values in prediction interval   70     82     92     97  
> cat("summary(earth.default, newdata=ozone1[1:100,]:)\n")
summary(earth.default, newdata=ozone1[1:100,]:)
> print(summary(earth.default, newdata=ozone1[1:100,]))

RSq 0.199 on newdata (100 cases)

                                 68%    80%    90%    95% 
newdata in prediction interval   76     84     91     95  
> plot(earth.default, level=.80, caption="earth.default")
> plotmo(earth.default, level=.80, col.response=3, caption="earth.default\nlevel = .80")
> 
> # TODO the following give err msg as expected, but do not give a try error
> # expect.err(try(summary(earth.mod1, newdata=c(1,2,3))))
> # expect.err(try(summary(earth.mod1, newdata=ozone1[1:100,1:3])))
> 
> multifigure("plot(earth.mod1)", 2, 2)
===plot(earth.mod1)
> set.seed(5)
> earth.mod2 <- earth(y~x, nfold=10, ncross=5, varmod.method="earth")
> plot(earth.mod2, caption="plot(earth.mod2)", level=.95)
> do.caption()
> 
> multifigure("plot(earth.mod2) with student=TRUE", 2, 2)
===plot(earth.mod2) with student=TRUE
> plot(earth.mod2, student=TRUE, level=.95,
+      caption="plot(earth.mod2, student=TRUE, level=.95)")
> do.caption()
> 
> multifigure("plot.varmod by calling plot(earth.mod2$varmod)", 2, 2)
===plot.varmod by calling plot(earth.mod2$varmod)
> plot(earth.mod2$varmod)
> 
> multifigure("embedded earth model by calling plot(earth.mod2$varmod$residmod)", 2, 2)
===embedded earth model by calling plot(earth.mod2$varmod$residmod)
> plot(earth.mod2$varmod$residmod, caption="embedded earth model")
> do.caption()
> 
> # test varmod.* args like varmod.conv
> 
> # cat("test varmod.exponent=.5\n")
> # set.seed(1)
> # (earth(Volume~Girth, data=trees, nfold=3, ncross=3, varmod.method="lm", trace=.3, varmod.exponent=.5))
> 
> # cat("test varmod.lambda=2/3\n")
> # set.seed(1)
> # (earth(Volume~Girth, data=trees, nfold=3, ncross=3, varmod.method="lm", trace=.3, varmod.lambda=2/3))
> 
> cat("test varmod.conv=50%\n")
test varmod.conv=50%
> set.seed(1)
> (earth(Volume~Girth, data=trees, nfold=3, ncross=3, varmod.method="lm", trace=.3, varmod.conv=50))

varmod method="lm" exponent=1 lambda=1 conv=50 clamp=0.1 minspan=-3:
     iter weight.ratio coefchange% (Intercept) Volume
        1           11           0        1.07  0.063
        2           22          36        0.59  0.080

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9425888
> 
> cat("test varmod.conv=-5\n")
test varmod.conv=-5
> set.seed(1)
> (earth(Volume~Girth, data=trees, nfold=3, ncross=3, varmod.method="lm", trace=.3, varmod.conv=-5))

varmod method="lm" exponent=1 lambda=1 conv=-5 clamp=0.1 minspan=-3:
     iter weight.ratio coefchange% (Intercept) Volume
        1           11         0.0        1.07  0.063
        2           22        36.3        0.59  0.080
        3           27        14.9        0.45  0.086
        4           28         5.2        0.42  0.087
        5           29         1.6        0.40  0.088

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9425888
> 
> cat("test varmod.clamp\n")
test varmod.clamp
> set.seed(1)
> a.noclamp <- earth(Volume~Girth, data=trees, nfold=3, ncross=3, varmod.method="lm")
> plot(a.noclamp$varmod, which=1:2, caption="a.noclamp and a.clamp", do.par=FALSE)
> set.seed(1)
> a.clamp <- earth(Volume~Girth, data=trees, nfold=3, ncross=3, varmod.method="lm", varmod.clamp=.6)
> plot(a.clamp$varmod, which=1:2, caption="", do.par=FALSE)
> 
> cat("test varmod.minspan=-5\n")
test varmod.minspan=-5
> set.seed(1)
> a.varmod.minspan.minus5 <- earth(Volume~Girth, data=trees, nfold=3, ncross=3, varmod.method="earth", trace=.3, varmod.minspan=-5)

varmod method="earth" exponent=1 lambda=1 conv=1 clamp=0.1 minspan=-5:
     iter weight.ratio coefchange% (Intercept) h(28.7668-Volume)
        1           34           0           4             -0.18

> print(coef(a.varmod.minspan.minus5$varmod))
      (Intercept) h(28.7668-Volume) 
         4.975862         -0.227696 
> cat("test varmod.minspan=1\n")
test varmod.minspan=1
> set.seed(1)
> a.varmod.minspan1 <- earth(Volume~Girth, data=trees, nfold=3, ncross=3, varmod.method="earth", trace=.3, varmod.minspan=1)

varmod method="earth" exponent=1 lambda=1 conv=1 clamp=0.1 minspan=1:
     iter weight.ratio coefchange% (Intercept) h(25.6817-Volume)
        1           25           0         3.8             -0.23

> print(coef(a.varmod.minspan1$varmod))
      (Intercept) h(25.6817-Volume) 
        4.7942482        -0.2863875 
> 
> # gam and y.gam are repeated below and on the repeat we will use the mgcv not gam package
> use.mgcv.package <- FALSE
> 
> for(varmod.method in c(earth:::VARMOD.METHODS, "gam", "x.gam")) {
+ 
+     multifigure(sprintf("varmod.method=\"%s\"", varmod.method), 2, 3)
+     par(mar = c(3, 3, 2, 3)) # space for right margin axis
+ 
+     if(varmod.method %in% c("gam", "x.gam")) {
+         if(use.mgcv.package)
+             library(mgcv)
+         else
+             library(gam)
+     }
+     set.seed(6)
+     earth.mod <- earth(Volume~Girth, data=trees, nfold=3, ncross=3,
+                        varmod.method=varmod.method,
+                        trace=if(varmod.method %in% c("const", "lm", "power")) .3 else 0)
+     printh(sprintf("varmod.method %s: summary(earth.mod)", varmod.method))
+     printh("summary(earth.mod)")
+     print(summary(earth.mod))
+ 
+     if(use.mgcv.package && (varmod.method == "x.gam" || varmod.method == "gam")) {
+         # summary(mgcv) prints environment as hex address which messes up the diffs
+         printh("skipping summary(mgcv::gam) etc.\n")
+     } else {
+         printh("earth.mod$varmod")
+         print(earth.mod$varmod, style="unit")
+ 
+         printh("summary(earth.mod$varmod)")
+         print(summary(earth.mod$varmod))
+ 
+         printh("summary(earth.mod$varmod$residmod)")
+         print(summary(earth.mod$varmod$residmod))
+     }
+     printh(sprintf("varmod.method %s: predict(earth.mod, interval=\"pint\")", varmod.method))
+     pints <- predict(earth.mod, interval="pint")
+     print(pints)
+ 
+     plotmo(earth.mod$varmod, do.par=FALSE, col.response=2, clip=FALSE,
+            main="plotmo residual model",
+            xlab="x", ylab="varmod residuals")
+ 
+     plotmo(earth.mod, level=.90, do.par=FALSE, col.response=1, clip=FALSE,
+            main="main model plotmo Girth")
+     do.caption()
+ 
+     plot(earth.mod, which=3, do.par=FALSE, level=.95)
+ 
+     # plot.varmod
+     plot(earth.mod$varmod, do.par=FALSE, which=1:3, info=(varmod.method=="earth"))
+ 
+     # on second use of gam and y.gam we want to use the mgcv package
+     if(varmod.method == "x.gam" && !use.mgcv.package) {
+         use.mgcv.package <- TRUE
+         detach("package:gam", unload=TRUE)
+     }
+ }
===varmod.method="const"

varmod method="const" exponent=1 lambda=1 conv=1 clamp=0.1 minspan=-3:
     iter weight.ratio coefchange% (Intercept)
        1            1           0         3.2

===varmod.method const: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "const"    min.sd 0.395

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)      3.95242    0.486831           12

                             mean   smallest   largest   ratio
95% prediction interval   15.4932    15.4932   15.4932       1

                                         68%    80%    90%    95% 
response values in prediction interval   81     94     97     97  
===earth.mod$varmod
method "const"    min.sd 0.395

stddev of predictions (scaled by unit):
            coefficients iter.stderr iter.stderr%
(Intercept)            1       0.123           12
unit                   4          NA           NA

                          mean   smallest   largest   ratio
95% prediction interval     15         15        15       1

                                         68%    80%    90%    95% 
response values in prediction interval   81     94     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "const"    min.sd 0.395

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)            4        0.49           12

                          mean   smallest   largest   ratio
95% prediction interval     15         15        15       1

                                         68%    80%    90%    95% 
response values in prediction interval   81     94     97     97  

Regression submodel (Abs Residuals):

Call:
lm(formula = abs.resids ~ 1, data = data, weights = weights, 
    y = TRUE)

Coefficients:
(Intercept)  
        3.2  

===summary(earth.mod$varmod$residmod)

Call:
lm(formula = abs.resids ~ 1, data = data, weights = weights, 
    y = TRUE)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7306 -2.0613  0.2056  1.2654  5.7009 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)   3.1536     0.3884   8.119 4.61e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.163 on 30 degrees of freedom

===varmod.method const: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  2.167253 17.66046
2  10.942195  3.195593 18.68880
3  11.627755  3.881154 19.37436
4  17.455018  9.708417 25.20162
5  18.140578 10.393977 25.88718
6  18.483359 10.736757 26.22996
7  19.168919 11.422317 26.91552
8  19.168919 11.422317 26.91552
9  19.511699 11.765098 27.25830
10 19.854479 12.107878 27.60108
11 20.197259 12.450658 27.94386
12 20.540040 12.793438 28.28664
13 20.540040 12.793438 28.28664
14 21.568380 13.821779 29.31498
15 22.596721 14.850119 30.34332
16 25.681742 17.935141 33.42834
17 25.681742 17.935141 33.42834
18 27.052863 19.306261 34.79946
19 28.423983 20.677382 36.17058
20 28.766764 21.020162 36.51337
21 30.080913 22.334312 37.82751
22 31.395063 23.648461 39.14166
23 33.366287 25.619685 41.11289
24 43.222408 35.475806 50.96901
25 45.193632 37.447031 52.94023
26 51.764379 44.017778 59.51098
27 53.078529 45.331927 60.82513
28 55.706828 47.960226 63.45343
29 56.363903 48.617301 64.11050
30 56.363903 48.617301 64.11050
31 73.447846 65.701244 81.19445
===varmod.method="power"

varmod method="power" exponent=1 lambda=1 conv=1 clamp=0.1 minspan=-3:

     start: (Intercept)=0.64    coef=0.083    exponent=1

     iter weight.ratio coefchange% (Intercept) coef exponent
        1           92        0.00       -18.4 14.3     0.12
        2           56      100.62        -4.0  2.0     0.38
        3           57        9.97        -3.6  1.8     0.40
        4           57        1.10        -3.6  1.7     0.41
        5           57        0.12        -3.6  1.7     0.41

===varmod.method power: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "power"    min.sd 0.396    iter.rsq 0.412

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)   -4.4635939      13.255          297
coef           2.1721602     8.69831          400
exponent       0.4067452    0.723675          178

                              mean   smallest    largest     ratio
95% prediction interval   15.50634   4.149491   31.38492   7.56356

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  
===earth.mod$varmod
method "power"    min.sd 0.396    iter.rsq 0.412

stddev of predictions (scaled by unit):
            coefficients iter.stderr iter.stderr%
(Intercept)        -2.06         6.1          297
coef                1.00           4          400
exponent            0.41         0.7          178
unit                2.17          NA           NA

                          mean   smallest   largest   ratio
95% prediction interval     16        4.1        31     7.6

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "power"    min.sd 0.396    iter.rsq 0.412

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)        -4.46        13.3          297
coef                2.17         8.7          400
exponent            0.41         0.7          178

                          mean   smallest   largest   ratio
95% prediction interval     16        4.1        31     7.6

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  

Regression submodel (Abs Residuals):

Nonlinear regression model
  model: abs.resids ~ `(Intercept)` + coef * RHS^exponent
   data: data
(Intercept)        coef    exponent 
      -3.56        1.73        0.41 
 weighted residual sum-of-squares: 51

Algorithm "port", convergence message: relative convergence (4)
===summary(earth.mod$varmod$residmod)

Formula: abs.resids ~ `(Intercept)` + coef * RHS^exponent

Parameters:
            Estimate Std. Error t value Pr(>|t|)
(Intercept)  -3.5614    10.5760  -0.337    0.739
coef          1.7331     6.9402   0.250    0.805
exponent      0.4067     0.7237   0.562    0.579

Residual standard error: 1.354 on 28 degrees of freedom

Algorithm "port", convergence message: relative convergence (4)

===varmod.method power: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.839109 11.98860
2  10.942195  8.424134 13.46026
3  11.627755  8.827746 14.42776
4  17.455018 12.580115 22.32992
5  18.140578 13.050522 23.23064
6  18.483359 13.287532 23.67918
7  19.168919 13.764993 24.57285
8  19.168919 13.764993 24.57285
9  19.511699 14.005377 25.01802
10 19.854479 14.246823 25.46214
11 20.197259 14.489301 25.90522
12 20.540040 14.732785 26.34729
13 20.540040 14.732785 26.34729
14 21.568380 15.469004 27.66776
15 22.596721 16.213374 28.98007
16 25.681742 18.489871 32.87361
17 25.681742 18.489871 32.87361
18 27.052863 19.520168 34.58556
19 28.423983 20.560565 36.28740
20 28.766764 20.822151 36.71138
21 30.080913 21.830225 38.33160
22 31.395063 22.846133 39.94399
23 33.366287 24.383570 42.34900
24 43.222408 32.271322 54.17349
25 45.193632 33.881941 56.50532
26 51.764379 39.313937 64.21482
27 53.078529 40.410811 65.74625
28 55.706828 42.613943 68.79971
29 56.363903 43.166594 69.56121
30 56.363903 43.166594 69.56121
31 73.447846 57.755384 89.14031
===varmod.method="power0"
===varmod.method power0: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "power0"    min.sd 0.4    iter.rsq 0.336

stddev of predictions:
         coefficients iter.stderr iter.stderr%
coef        0.1602904    0.123432           77
exponent    0.9464063    0.232088           25

                             mean   smallest    largest      ratio
95% prediction interval   15.6918   5.508532   36.65726   6.654634

                                         68%    80%    90%    95% 
response values in prediction interval   74     90     97     97  
===earth.mod$varmod
method "power0"    min.sd 0.4    iter.rsq 0.336

stddev of predictions (scaled by unit):
         coefficients iter.stderr iter.stderr%
coef             0.17        0.13           77
exponent         0.95       0.232           25
unit             0.95          NA           NA

                          mean   smallest   largest   ratio
95% prediction interval     16        5.5        37     6.7

                                         68%    80%    90%    95% 
response values in prediction interval   74     90     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "power0"    min.sd 0.4    iter.rsq 0.336

stddev of predictions:
         coefficients iter.stderr iter.stderr%
coef             0.16       0.123           77
exponent         0.95       0.232           25

                          mean   smallest   largest   ratio
95% prediction interval     16        5.5        37     6.7

                                         68%    80%    90%    95% 
response values in prediction interval   74     90     97     97  

Regression submodel (Abs Residuals):

Nonlinear regression model
  model: abs.resids ~ coef * RHS^exponent
   data: data
    coef exponent 
    0.13     0.95 
 weighted residual sum-of-squares: 66

Algorithm "port", convergence message: relative convergence (4)
===summary(earth.mod$varmod$residmod)

Formula: abs.resids ~ coef * RHS^exponent

Parameters:
         Estimate Std. Error t value Pr(>|t|)    
coef      0.12789    0.09848   1.299 0.204309    
exponent  0.94641    0.23209   4.078 0.000324 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.503 on 29 degrees of freedom

Algorithm "port", convergence message: relative convergence (4)

===varmod.method power0: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.159589 12.66812
2  10.942195  7.918273 13.96612
3  11.627755  8.424824 14.83069
4  17.455018 12.750482 22.15955
5  18.140578 13.261352 23.01981
6  18.483359 13.516920 23.44980
7  19.168919 14.028315 24.30952
8  19.168919 14.028315 24.30952
9  19.511699 14.284139 24.73926
10 19.854479 14.540044 25.16891
11 20.197259 14.796030 25.59849
12 20.540040 15.052094 26.02798
13 20.540040 15.052094 26.02798
14 21.568380 15.820748 27.31601
15 22.596721 16.590064 28.60338
16 25.681742 18.901688 32.46180
17 25.681742 18.901688 32.46180
18 27.052863 19.930710 34.17502
19 28.423983 20.960660 35.88731
20 28.766764 21.218287 36.31524
21 30.080913 22.206475 37.95535
22 31.395063 23.195425 39.59470
23 33.366287 24.680206 42.05237
24 43.222408 32.125527 54.31929
25 45.193632 33.618360 56.76890
26 51.764379 38.602272 64.92649
27 53.078529 39.600395 66.55666
28 55.706828 41.597887 69.81577
29 56.363903 42.097512 70.63029
30 56.363903 42.097512 70.63029
31 73.447846 55.119215 91.77648
===varmod.method="lm"

varmod method="lm" exponent=1 lambda=1 conv=1 clamp=0.1 minspan=-3:
     iter weight.ratio coefchange% (Intercept) Volume
        1           21         0.0      0.6418  0.083
        2           46        52.8      0.1132  0.103
        3           55        53.1     -0.0017  0.107
        4           57       674.9     -0.0252  0.108
        5           58         9.4     -0.0298  0.109
        6           58         1.6     -0.0308  0.109
        7           58         0.3     -0.0310  0.109

===varmod.method lm: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "lm"    min.sd 0.407    iter.rsq 0.335

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)  -0.03879849    0.745704          big
Volume        0.13615120   0.0356065           26

                              mean   smallest    largest      ratio
95% prediction interval   15.95025   5.138966   39.04724   7.598269

                                         68%    80%    90%    95% 
response values in prediction interval   74     90     97     97  
===earth.mod$varmod
method "lm"    min.sd 0.407    iter.rsq 0.335

stddev of predictions (scaled by unit):
            coefficients iter.stderr iter.stderr%
(Intercept)        -0.28         5.5          big
Volume              1.00         0.3           26
unit                0.14          NA           NA

                          mean   smallest   largest   ratio
95% prediction interval     16        5.1        39     7.6

                                         68%    80%    90%    95% 
response values in prediction interval   74     90     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "lm"    min.sd 0.407    iter.rsq 0.335

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)       -0.039        0.75          big
Volume             0.136        0.04           26

                          mean   smallest   largest   ratio
95% prediction interval     16        5.1        39     7.6

                                         68%    80%    90%    95% 
response values in prediction interval   74     90     97     97  

Regression submodel (Abs Residuals):

Call:
lm(formula = abs.resids ~ ., data = data, weights = weights, 
    y = TRUE)

Coefficients:
(Intercept)          RHS  
     -0.031        0.109  

===summary(earth.mod$varmod$residmod)

Call:
lm(formula = abs.resids ~ ., data = data, weights = weights, 
    y = TRUE)

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-1.8002 -0.9678 -0.2648  0.8667  4.9654 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.03096    0.59499  -0.052 0.958862    
RHS          0.10863    0.02841   3.824 0.000644 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.47 on 29 degrees of freedom
Multiple R-squared:  0.3352,	Adjusted R-squared:  0.3123 
F-statistic: 14.62 on 1 and 29 DF,  p-value: 0.0006442

===varmod.method lm: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.344372 12.48334
2  10.942195  8.098298 13.78609
3  11.627755  8.600916 14.65460
4  17.455018 12.873165 22.03687
5  18.140578 13.375782 22.90537
6  18.483359 13.627091 23.33963
7  19.168919 14.129709 24.20813
8  19.168919 14.129709 24.20813
9  19.511699 14.381017 24.64238
10 19.854479 14.632326 25.07663
11 20.197259 14.883635 25.51088
12 20.540040 15.134944 25.94514
13 20.540040 15.134944 25.94514
14 21.568380 15.888870 27.24789
15 22.596721 16.642796 28.55064
16 25.681742 18.904575 32.45891
17 25.681742 18.904575 32.45891
18 27.052863 19.909811 34.19591
19 28.423983 20.915046 35.93292
20 28.766764 21.166354 36.36717
21 30.080913 22.129821 38.03200
22 31.395063 23.093288 39.69684
23 33.366287 24.538488 42.19409
24 43.222408 31.764489 54.68033
25 45.193632 33.209689 57.17758
26 51.764379 38.027023 65.50174
27 53.078529 38.990490 67.16657
28 55.706828 40.917423 70.49623
29 56.363903 41.399157 71.32865
30 56.363903 41.399157 71.32865
31 73.447846 53.924225 92.97147
===varmod.method="rlm"
===varmod.method rlm: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "rlm"    min.sd 0.37    iter.rsq 0.321

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)  0.006354079    0.661039          big
Volume       0.122346899   0.0313398           26

                              mean   smallest    largest      ratio
95% prediction interval   14.49463   4.779503   35.24984   7.375209

                                         68%    80%    90%    95% 
response values in prediction interval   71     87     97     97  
===earth.mod$varmod
method "rlm"    min.sd 0.37    iter.rsq 0.321

stddev of predictions (scaled by unit):
            coefficients iter.stderr iter.stderr%
(Intercept)        0.052         5.4          big
Volume             1.000         0.3           26
unit               0.122          NA           NA

                          mean   smallest   largest   ratio
95% prediction interval     14        4.8        35     7.4

                                         68%    80%    90%    95% 
response values in prediction interval   71     87     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "rlm"    min.sd 0.37    iter.rsq 0.321

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)       0.0064        0.66          big
Volume            0.1223        0.03           26

                          mean   smallest   largest   ratio
95% prediction interval     14        4.8        35     7.4

                                         68%    80%    90%    95% 
response values in prediction interval   71     87     97     97  

Regression submodel (Abs Residuals):

Call:
rlm(formula = abs.resids ~ ., data = data, weights = weights, 
    method = "MM")
Converged in 6 iterations

Coefficients:
(Intercept)         RHS 
     0.0051      0.0976 

Degrees of freedom: 31 total; 29 residual
Scale estimate: 1.26 
===summary(earth.mod$varmod$residmod)

Call: rlm(formula = abs.resids ~ ., data = data, weights = weights, 
    method = "MM")
Residuals:
     Min       1Q   Median       3Q      Max 
-1.61443 -0.77191 -0.07396  1.05178  5.20997 

Coefficients:
            Value  Std. Error t value
(Intercept) 0.0051 0.5274     0.0096 
RHS         0.0976 0.0250     3.9039 

Residual standard error: 1.257 on 29 degrees of freedom
===varmod.method rlm: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.524103 12.30361
2  10.942195  8.305852 13.57854
3  11.627755  8.827018 14.42849
4  17.455018 13.256929 21.65311
5  18.140578 13.778095 22.50306
6  18.483359 14.038678 22.92804
7  19.168919 14.559844 23.77799
8  19.168919 14.559844 23.77799
9  19.511699 14.820427 24.20297
10 19.854479 15.081010 24.62795
11 20.197259 15.341593 25.05293
12 20.540040 15.602176 25.47790
13 20.540040 15.602176 25.47790
14 21.568380 16.383926 26.75283
15 22.596721 17.165675 28.02777
16 25.681742 19.510922 31.85256
17 25.681742 19.510922 31.85256
18 27.052863 20.553254 33.55247
19 28.423983 21.595586 35.25238
20 28.766764 21.856169 35.67736
21 30.080913 22.855191 37.30663
22 31.395063 23.854214 38.93591
23 33.366287 25.352747 41.37983
24 43.222408 32.845415 53.59940
25 45.193632 34.343948 56.04332
26 51.764379 39.339060 64.18970
27 53.078529 40.338082 65.81898
28 55.706828 42.336127 69.07753
29 56.363903 42.835638 69.89217
30 56.363903 42.835638 69.89217
31 73.447846 55.822928 91.07276
===varmod.method="earth"
===varmod.method earth: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "earth"    min.sd 0.409    iter.rsq 0.357

stddev of predictions:
                  coefficients iter.stderr iter.stderr%
(Intercept)          5.2245810    0.507949           10
h(25.6817-Volume)   -0.3413957   0.0850395           25

                              mean   smallest    largest      ratio
95% prediction interval   15.59232   1.603035   20.47998   12.77575

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  
===earth.mod$varmod
method "earth"    min.sd 0.409    iter.rsq 0.357

stddev of predictions (scaled by unit):
                  coefficients iter.stderr iter.stderr%
(Intercept)                 15        1.49           10
h(25.6817-Volume)           -1        0.25           25

                          mean   smallest   largest   ratio
95% prediction interval     16        1.6        20      13

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "earth"    min.sd 0.409    iter.rsq 0.357

stddev of predictions:
                  coefficients iter.stderr iter.stderr%
(Intercept)               5.22        0.51           10
h(25.6817-Volume)        -0.34        0.09           25

                          mean   smallest   largest   ratio
95% prediction interval     16        1.6        20      13

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  

Regression submodel (Abs Residuals):

Selected 2 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: RHS
Number of terms at each degree of interaction: 1 1 (additive model)
GCV 3.6    RSS 90    GRSq 0.26    RSq 0.36
===summary(earth.mod$varmod$residmod)
Call: earth(formula=abs.resids~., data=data, weights=weights, 
      keepxy=TRUE, trace=trace, minspan=minspan, degree=..1)

               coefficients
(Intercept)       4.1686125
h(25.6817-RHS)   -0.2723944

Selected 2 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: RHS
Number of terms at each degree of interaction: 1 1 (additive model)
GCV 3.566364    RSS 90.19449    GRSq 0.2621167    RSq 0.3572216
===varmod.method earth: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  9.112337 10.71537
2  10.942195 10.140677 11.74371
3  11.627755 10.791615 12.46390
4  17.455018 12.719720 22.19032
5  18.140578 12.946556 23.33460
6  18.483359 13.059974 23.90674
7  19.168919 13.286810 25.05103
8  19.168919 13.286810 25.05103
9  19.511699 13.400228 25.62317
10 19.854479 13.513646 26.19531
11 20.197259 13.627064 26.76745
12 20.540040 13.740482 27.33960
13 20.540040 13.740482 27.33960
14 21.568380 14.080736 29.05602
15 22.596721 14.420990 30.77245
16 25.681742 15.441751 35.92173
17 25.681742 15.441751 35.92173
18 27.052863 16.812872 37.29285
19 28.423983 18.183993 38.66397
20 28.766764 18.526773 39.00675
21 30.080913 19.840922 40.32090
22 31.395063 21.155072 41.63505
23 33.366287 23.126296 43.60628
24 43.222408 32.982417 53.46240
25 45.193632 34.953641 55.43362
26 51.764379 41.524389 62.00437
27 53.078529 42.838538 63.31852
28 55.706828 45.466837 65.94682
29 56.363903 46.123912 66.60389
30 56.363903 46.123912 66.60389
31 73.447846 63.207855 83.68784
===varmod.method="gam"
Loading required package: splines
Loaded gam 1.09.1

===varmod.method gam: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "gam" (gam package)    min.sd 0.391    iter.rsq 0.427

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)   0.04419128    0.636362          big
s(Volume)     0.12705067   0.0305905           24

                              mean   smallest    largest      ratio
95% prediction interval   15.31349   4.663216   31.26479   6.704555

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  
===earth.mod$varmod
method "gam" (gam package)    min.sd 0.391    iter.rsq 0.427

stddev of predictions (scaled by unit):
            coefficients iter.stderr iter.stderr%
(Intercept)         0.35           5          big
s(Volume)           1.00         0.2           24
unit                0.13          NA           NA

                          mean   smallest   largest   ratio
95% prediction interval     15        4.7        31     6.7

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "gam" (gam package)    min.sd 0.391    iter.rsq 0.427

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)        0.044        0.64          big
s(Volume)          0.127        0.03           24

                          mean   smallest   largest   ratio
95% prediction interval     15        4.7        31     6.7

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  

Regression submodel (Abs Residuals):

Call:
gam::gam(formula = formula, data = data, weights = weights, x = TRUE, 
    y = TRUE)

Degrees of Freedom: 30 total; 26 Residual
Residual Deviance: 46.88 
===summary(earth.mod$varmod$residmod)

Call: gam::gam(formula = formula, data = data, weights = weights, x = TRUE, 
    y = TRUE)
Deviance Residuals:
     Min       1Q   Median       3Q      Max 
-1.71343 -0.82554 -0.04588  0.52511  3.71485 

(Dispersion Parameter for gaussian family taken to be 1.8031)

    Null Deviance: 81.8534 on 30 degrees of freedom
Residual Deviance: 46.8801 on 25.9999 degrees of freedom
AIC: 128.7708 

Number of Local Scoring Iterations: 2 

Anova for Parametric Effects
          Df Sum Sq Mean Sq F value    Pr(>F)    
s(RHS)     1 31.103 31.1027   17.25 0.0003132 ***
Residuals 26 46.880  1.8031                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Anova for Nonparametric Effects
            Npar Df  Npar F  Pr(F)
(Intercept)                       
s(RHS)            3 0.71555 0.5516
===varmod.method gam: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.582247 12.24546
2  10.942195  8.345030 13.53936
3  11.627755  8.862796 14.39271
4  17.455018 13.314941 21.59510
5  18.140578 13.763233 22.51792
6  18.483359 13.976520 22.99020
7  19.168919 14.384310 23.95353
8  19.168919 14.384310 23.95353
9  19.511699 14.580731 24.44267
10 19.854479 14.772634 24.93632
11 20.197259 14.959561 25.43496
12 20.540040 15.141423 25.93866
13 20.540040 15.141423 25.93866
14 21.568380 15.654530 27.48223
15 22.596721 16.133996 29.05945
16 25.681742 17.696141 33.66734
17 25.681742 17.696141 33.66734
18 27.052863 18.576596 35.52913
19 28.423983 19.568728 37.27924
20 28.766764 19.832058 37.70147
21 30.080913 20.891612 39.27021
22 31.395063 22.010890 40.77924
23 33.366287 23.736538 42.99604
24 43.222408 32.611895 53.83292
25 45.193632 34.389205 55.99806
26 51.764379 40.051363 63.47740
27 53.078529 41.140361 65.01670
28 55.706828 43.286595 68.12706
29 56.363903 43.819812 68.90799
30 56.363903 43.819812 68.90799
31 73.447846 57.815453 89.08024
===varmod.method="x.lm"
===varmod.method x.lm: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "x.lm"    min.sd 0.395    iter.rsq 0.413

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)   -3.6679984     1.36727           37
Girth          0.5753881    0.127394           22

                              mean   smallest   largest      ratio
95% prediction interval   15.50318   4.342195   32.0846   7.389028

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  
===earth.mod$varmod
method "x.lm"    min.sd 0.395    iter.rsq 0.413

stddev of predictions (scaled by unit):
            coefficients iter.stderr iter.stderr%
(Intercept)        -6.37        2.38           37
Girth               1.00        0.22           22
unit                0.58          NA           NA

                          mean   smallest   largest   ratio
95% prediction interval     16        4.3        32     7.4

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "x.lm"    min.sd 0.395    iter.rsq 0.413

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)        -3.67        1.37           37
Girth               0.58        0.13           22

                          mean   smallest   largest   ratio
95% prediction interval     16        4.3        32     7.4

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  

Regression submodel (Abs Residuals):

Call:
lm(formula = abs.resids ~ ., data = data, weights = weights, 
    y = TRUE)

Coefficients:
(Intercept)        Girth  
      -2.93         0.46  

===summary(earth.mod$varmod$residmod)

Call:
lm(formula = abs.resids ~ ., data = data, weights = weights, 
    y = TRUE)

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-1.7515 -0.9290 -0.0692  0.6552  4.2319 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -2.9266     1.0909  -2.683   0.0119 *  
Girth         0.4591     0.1016   4.517  9.7e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.313 on 29 degrees of freedom
Multiple R-squared:  0.413,	Adjusted R-squared:  0.3927 
F-statistic:  20.4 on 1 and 29 DF,  p-value: 9.698e-05

===varmod.method x.lm: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.742757 12.08495
2  10.942195  8.432776 13.45161
3  11.627755  8.892788 14.36272
4  17.455018 12.802893 22.10714
5  18.140578 13.262905 23.01825
6  18.483359 13.492911 23.47381
7  19.168919 13.952923 24.38491
8  19.168919 13.952923 24.38491
9  19.511699 14.182930 24.84047
10 19.854479 14.412936 25.29602
11 20.197259 14.642942 25.75158
12 20.540040 14.872948 26.20713
13 20.540040 14.872948 26.20713
14 21.568380 15.562967 27.57379
15 22.596721 16.252985 28.94046
16 25.681742 18.323041 33.04044
17 25.681742 18.323041 33.04044
18 27.052863 19.243065 34.86266
19 28.423983 20.163090 36.68488
20 28.766764 20.393096 37.14043
21 30.080913 21.481698 38.68013
22 31.395063 22.570299 40.21983
23 33.366287 24.203201 42.52937
24 43.222408 32.367712 54.07710
25 45.193632 34.000614 56.38665
26 51.764379 39.443622 64.08514
27 53.078529 40.532223 65.62483
28 55.706828 42.709426 68.70423
29 56.363903 43.253727 69.47408
30 56.363903 43.253727 69.47408
31 73.447846 57.405546 89.49015
===varmod.method="x.rlm"
===varmod.method x.rlm: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "x.rlm"    min.sd 0.372    iter.rsq 0.405

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)   -3.3563291     1.27704           38
Girth          0.5343981    0.118062           22

                              mean   smallest    largest      ratio
95% prediction interval   14.59618   4.230288   29.99635   7.090853

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  
===earth.mod$varmod
method "x.rlm"    min.sd 0.372    iter.rsq 0.405

stddev of predictions (scaled by unit):
            coefficients iter.stderr iter.stderr%
(Intercept)        -6.28        2.39           38
Girth               1.00        0.22           22
unit                0.53          NA           NA

                          mean   smallest   largest   ratio
95% prediction interval     15        4.2        30     7.1

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "x.rlm"    min.sd 0.372    iter.rsq 0.405

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)        -3.36        1.28           38
Girth               0.53        0.12           22

                          mean   smallest   largest   ratio
95% prediction interval     15        4.2        30     7.1

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  

Regression submodel (Abs Residuals):

Call:
rlm(formula = abs.resids ~ ., data = data, weights = weights, 
    method = "MM", y.ret = TRUE)
Converged in 6 iterations

Coefficients:
(Intercept)       Girth 
      -2.68        0.43 

Degrees of freedom: 31 total; 29 residual
Scale estimate: 1.28 
===summary(earth.mod$varmod$residmod)

Call: rlm(formula = abs.resids ~ ., data = data, weights = weights, 
    method = "MM", y.ret = TRUE)
Residuals:
     Min       1Q   Median       3Q      Max 
-1.65981 -0.82767  0.07389  0.79998  4.45110 

Coefficients:
            Value   Std. Error t value
(Intercept) -2.6780  1.0189    -2.6282
Girth        0.4264  0.0942     4.5264

Residual standard error: 1.283 on 29 degrees of freedom
===varmod.method x.rlm: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.798710 12.02900
2  10.942195  8.512831 13.37156
3  11.627755  8.988911 14.26660
4  17.455018 13.035592 21.87444
5  18.140578 13.511672 22.76949
6  18.483359 13.749712 23.21701
7  19.168919 14.225792 24.11205
8  19.168919 14.225792 24.11205
9  19.511699 14.463832 24.55957
10 19.854479 14.701872 25.00709
11 20.197259 14.939912 25.45461
12 20.540040 15.177952 25.90213
13 20.540040 15.177952 25.90213
14 21.568380 15.892073 27.24469
15 22.596721 16.606193 28.58725
16 25.681742 18.748553 32.61493
17 25.681742 18.748553 32.61493
18 27.052863 19.700714 34.40501
19 28.423983 20.652874 36.19509
20 28.766764 20.890914 36.64261
21 30.080913 21.995583 38.16624
22 31.395063 23.100253 39.68987
23 33.366287 24.757256 41.97532
24 43.222408 33.042276 53.40254
25 45.193632 34.699280 55.68798
26 51.764379 40.222626 63.30613
27 53.078529 41.327296 64.82976
28 55.706828 43.536634 67.87702
29 56.363903 44.088969 68.63884
30 56.363903 44.088969 68.63884
31 73.447846 58.449670 88.44602
===varmod.method="x.earth"
===varmod.method x.earth: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "x.earth"    min.sd 0.395    iter.rsq 0.393

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)    2.4330352    0.521236           21
h(Girth-11)    0.6038582    0.139326           23

                             mean   smallest   largest      ratio
95% prediction interval   15.4932   9.537323   32.2613   3.382637

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  
===earth.mod$varmod
method "x.earth"    min.sd 0.395    iter.rsq 0.393

stddev of predictions (scaled by unit):
            coefficients iter.stderr iter.stderr%
(Intercept)            4        0.86           21
h(Girth-11)            1        0.23           23

                          mean   smallest   largest   ratio
95% prediction interval     15        9.5        32     3.4

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "x.earth"    min.sd 0.395    iter.rsq 0.393

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)          2.4        0.52           21
h(Girth-11)          0.6        0.14           23

                          mean   smallest   largest   ratio
95% prediction interval     15        9.5        32     3.4

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  

Regression submodel (Abs Residuals):

Selected 2 of 5 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 5 terms
Importance: Girth
Number of terms at each degree of interaction: 1 1 (additive model)
GCV 3.4    RSS 85    GRSq 0.3    RSq 0.39
===summary(earth.mod$varmod$residmod)
Call: earth(formula=abs.resids~., data=data, weights=weights, 
      keepxy=TRUE, trace=trace, minspan=minspan, degree=..1)

            coefficients
(Intercept)    1.9412812
h(Girth-11)    0.4818091

Selected 2 of 5 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 5 terms
Importance: Girth
Number of terms at each degree of interaction: 1 1 (additive model)
GCV 3.367223    RSS 85.15816    GRSq 0.303319    RSq 0.3931134
===varmod.method x.earth: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  5.145193 14.68252
2  10.942195  6.173534 15.71086
3  11.627755  6.859094 16.39642
4  17.455018 12.686357 22.22368
5  18.140578 13.371917 22.90924
6  18.483359 13.714697 23.25202
7  19.168919 14.400258 23.93758
8  19.168919 14.400258 23.93758
9  19.511699 14.624684 24.39871
10 19.854479 14.849110 24.85985
11 20.197259 15.073536 25.32098
12 20.540040 15.297962 25.78212
13 20.540040 15.297962 25.78212
14 21.568380 15.971241 27.16552
15 22.596721 16.644519 28.54892
16 25.681742 18.664354 32.69913
17 25.681742 18.664354 32.69913
18 27.052863 19.562059 34.54367
19 28.423983 20.459763 36.38820
20 28.766764 20.684189 36.84934
21 30.080913 21.761631 38.40020
22 31.395063 22.839072 39.95105
23 33.366287 24.455234 42.27734
24 43.222408 32.536045 53.90877
25 45.193632 34.152207 56.23506
26 51.764379 39.539414 63.98935
27 53.078529 40.616855 65.54020
28 55.706828 42.771738 68.64192
29 56.363903 43.310459 69.41735
30 56.363903 43.310459 69.41735
31 73.447846 57.317197 89.57849
===varmod.method="x.gam"
===varmod.method x.gam: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "x.gam" (gam package)    min.sd 0.391    iter.rsq 0.436

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)   -3.5719842     1.41142           40
s(Volume)      0.5596293    0.130587           23

                              mean   smallest    largest      ratio
95% prediction interval   15.32406   4.649214   30.88279   6.642584

                                         68%    80%    90%     95% 
response values in prediction interval   84     90     97     100  
===earth.mod$varmod
method "x.gam" (gam package)    min.sd 0.391    iter.rsq 0.436

stddev of predictions (scaled by unit):
            coefficients iter.stderr iter.stderr%
(Intercept)        -6.38        2.52           40
s(Volume)           1.00        0.23           23
unit                0.56          NA           NA

                          mean   smallest   largest   ratio
95% prediction interval     15        4.6        31     6.6

                                         68%    80%    90%     95% 
response values in prediction interval   84     90     97     100  
===summary(earth.mod$varmod)
Parent model: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
              c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
              varmod.method=varmod.method)

method "x.gam" (gam package)    min.sd 0.391    iter.rsq 0.436

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)        -3.57        1.41           40
s(Volume)           0.56        0.13           23

                          mean   smallest   largest   ratio
95% prediction interval     15        4.6        31     6.6

                                         68%    80%    90%     95% 
response values in prediction interval   84     90     97     100  

Regression submodel (Abs Residuals):

Call:
gam::gam(formula = formula, data = data, weights = weights, x = TRUE, 
    y = TRUE)

Degrees of Freedom: 30 total; 26 Residual
Residual Deviance: 44.63 
===summary(earth.mod$varmod$residmod)

Call: gam::gam(formula = formula, data = data, weights = weights, x = TRUE, 
    y = TRUE)
Deviance Residuals:
     Min       1Q   Median       3Q      Max 
-1.68178 -0.79389 -0.07891  0.47924  3.39854 

(Dispersion Parameter for gaussian family taken to be 1.7165)

    Null Deviance: 79.0921 on 30 degrees of freedom
Residual Deviance: 44.6296 on 26 degrees of freedom
AIC: 127.6762 

Number of Local Scoring Iterations: 2 

Anova for Parametric Effects
          Df Sum Sq Mean Sq F value    Pr(>F)    
s(RHS)     1 31.525 31.5247  18.365 0.0002213 ***
Residuals 26 44.630  1.7165                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Anova for Nonparametric Effects
            Npar Df  Npar F  Pr(F)
(Intercept)                       
s(RHS)            3 0.57049 0.6395
===varmod.method x.gam: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.589247 12.23846
2  10.942195  8.303333 13.58106
3  11.627755  8.803847 14.45166
4  17.455018 13.528708 21.38133
5  18.140578 13.974117 22.30704
6  18.483359 14.178601 22.78812
7  19.168919 14.559874 23.77796
8  19.168919 14.559874 23.77796
9  19.511699 14.741854 24.28154
10 19.854479 14.918936 24.79002
11 20.197259 15.089276 25.30524
12 20.540040 15.251941 25.82814
13 20.540040 15.251941 25.82814
14 21.568380 15.679535 27.45723
15 22.596721 16.037032 29.15641
16 25.681742 17.309182 34.05430
17 25.681742 17.309182 34.05430
18 27.052863 18.195628 35.91010
19 28.423983 19.235349 37.61262
20 28.766764 19.512145 38.02138
21 30.080913 20.709736 39.45209
22 31.395063 21.920078 40.87005
23 33.366287 23.736134 42.99644
24 43.222408 32.655177 53.78964
25 45.193632 34.399598 55.98767
26 51.764379 40.049431 63.47933
27 53.078529 41.153431 65.00363
28 55.706828 43.342601 68.07106
29 56.363903 43.887440 68.84036
30 56.363903 43.887440 68.84036
31 73.447846 58.006448 88.88924
===varmod.method="gam"
Loading required package: nlme
This is mgcv 1.8-4. For overview type 'help("mgcv-package")'.
===varmod.method gam: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "gam" (mgcv package)    min.sd 0.406    iter.rsq 0.331

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)     4.058828    0.514738           13
s(Volume).1     0.000000          NA           NA
s(Volume).2     0.000000          NA           NA
s(Volume).3     0.000000          NA           NA
s(Volume).4     0.000000          NA           NA
s(Volume).5     0.000000          NA           NA
s(Volume).6     0.000000          NA           NA
s(Volume).7     0.000000          NA           NA
s(Volume).8     0.000000          NA           NA
s(Volume).9     2.134571          NA           NA

                              mean   smallest    largest      ratio
95% prediction interval   15.91031   5.222227   38.74412   7.419079

                                         68%    80%    90%    95% 
response values in prediction interval   74     90     97     97  
===skipping summary(mgcv::gam) etc.

===varmod.method gam: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.302741 12.52497
2  10.942195  8.059794 13.82460
3  11.627755  8.564496 14.69101
4  17.455018 12.854465 22.05557
5  18.140578 13.359167 22.92199
6  18.483359 13.611518 23.35520
7  19.168919 14.116220 24.22162
8  19.168919 14.116220 24.22162
9  19.511699 14.368571 24.65483
10 19.854479 14.620923 25.08804
11 20.197259 14.873274 25.52125
12 20.540040 15.125625 25.95445
13 20.540040 15.125625 25.95445
14 21.568380 15.882678 27.25408
15 22.596721 16.639731 28.55371
16 25.681742 18.910891 32.45259
17 25.681742 18.910891 32.45259
18 27.052863 19.920295 34.18543
19 28.423983 20.929700 35.91827
20 28.766764 21.182051 36.35148
21 30.080913 22.149514 38.01231
22 31.395063 23.116977 39.67315
23 33.366287 24.568171 42.16440
24 43.222408 31.824142 54.62067
25 45.193632 33.275336 57.11193
26 51.764379 38.112650 65.41611
27 53.078529 39.080113 67.07695
28 55.706828 41.015038 70.39862
29 56.363903 41.498770 71.22904
30 56.363903 41.498770 71.22904
31 73.447846 54.075786 92.81991
===varmod.method="x.gam"
===varmod.method x.gam: summary(earth.mod)
===summary(earth.mod)
Call: earth(formula=Volume~Girth, data=trees, trace=if(varmod.method%in%
      c("const", "lm", "power"))0.3else0, ncross=3, nfold=3, 
      varmod.method=varmod.method)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "x.gam" (mgcv package)    min.sd 0.396    iter.rsq 0.408

stddev of predictions:
            coefficients iter.stderr iter.stderr%
(Intercept)     3.956235    0.455909           12
s(Volume).1     0.000000          NA           NA
s(Volume).2     0.000000          NA           NA
s(Volume).3     0.000000          NA           NA
s(Volume).4     0.000000          NA           NA
s(Volume).5     0.000000          NA           NA
s(Volume).6     0.000000          NA           NA
s(Volume).7     0.000000          NA           NA
s(Volume).8     0.000000          NA           NA
s(Volume).9     1.779045          NA           NA

                              mean   smallest    largest      ratio
95% prediction interval   15.50816   4.329829   32.11533   7.417229

                                         68%    80%    90%    95% 
response values in prediction interval   77     90     97     97  
===skipping summary(mgcv::gam) etc.

===varmod.method x.gam: predict(earth.mod, interval="pint")
         fit       lwr      upr
1   9.913855  7.748940 12.07877
2  10.942195  8.438433 13.44596
3  11.627755  8.898095 14.35742
4  17.455018 12.805221 22.10482
5  18.140578 13.264883 23.01627
6  18.483359 13.494714 23.47200
7  19.168919 13.954376 24.38346
8  19.168919 13.954376 24.38346
9  19.511699 14.184207 24.83919
10 19.854479 14.414038 25.29492
11 20.197259 14.643869 25.75065
12 20.540040 14.873700 26.20638
13 20.540040 14.873700 26.20638
14 21.568380 15.563193 27.57357
15 22.596721 16.252686 28.94076
16 25.681742 18.321164 33.04232
17 25.681742 18.321164 33.04232
18 27.052863 19.240488 34.86524
19 28.423983 20.159812 36.68815
20 28.766764 20.389643 37.14388
21 30.080913 21.477894 38.68393
22 31.395063 22.566145 40.22398
23 33.366287 24.198522 42.53405
24 43.222408 32.360405 54.08441
25 45.193632 33.992781 56.39448
26 51.764379 39.434037 64.09472
27 53.078529 40.522288 65.63477
28 55.706828 42.698790 68.71487
29 56.363903 43.242915 69.48489
30 56.363903 43.242915 69.48489
31 73.447846 57.390179 89.50551
> # test varmod.exponent
> set.seed(6)
> earth.exponent <- earth(Volume~Girth, data=trees, nfold=3, ncross=3,
+                         varmod.method="lm", varmod.exponent=.5)
> printh("summary(earth.exponent)")
===summary(earth.exponent)
> print(summary(earth.exponent))
Call: earth(formula=Volume~Girth, data=trees, ncross=3, nfold=3, 
      varmod.method="lm", varmod.exponent=0.5)

              coefficients
(Intercept)      28.766764
h(13.8-Girth)    -3.427802
h(Girth-13.8)     6.570747

Selected 3 of 4 terms, and 1 of 1 predictors 
Termination condition: RSq changed by less than 0.001 at 4 terms
Importance: Girth
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 14.20145  RSS 309.6832  GRSq 0.949137  RSq 0.9617962  CVRSq 0.9151857

Note: the cross-validation sd's below are standard deviations across folds

Cross validation:   nterms 3.00 sd 0.00    nvars 1.00 sd 0.00

     CVRSq    sd     MaxErr  sd
      0.92 0.045         14 8.5

varmod: method "lm"  exponent 0.500  min.sd 0.397  iter.rsq 0.401

stddev of predictions:
             coefficients iter.stderr iter.stderr%
(Intercept)     -3.090142      1.2774           41
sqrt(Volume)     1.327517    0.300982           23

                             mean   smallest    largest      ratio
95% prediction interval   15.5693   4.271595   32.48406   7.604668

                                         68%    80%    90%    95% 
response values in prediction interval   81     90     97     97  
> 
> par(old.par)
> 
> if(!interactive()) {
+     dev.off()         # finish postscript plot
+     q(runLast=FALSE)  # needed else R prints the time on exit (R2.5 and higher) which messes up the diffs
+ }
