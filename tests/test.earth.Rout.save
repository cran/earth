

> # test.earth.R
> # The intention here is to check for porting problems by building
> # a model with tracing enabled, and to call each earth routine once.
> # For more comprehensive tests see earth\src\tests.
> # Not tested: mars.to.earth, plot.earth, plot.earth.models, plotmo
> library(earth)
Loading required package: leaps
Loading required package: plotmo
Loading required package: plotrix
> options(digits=3)
> data(trees)
> fit1 <- earth(Volume ~ ., data = trees, degree = 2, trace = 0)
> print(fit1, digits = 3)
Selected 4 of 7 terms, and 2 of 2 predictors 
Importance: Girth, Height
Number of terms at each degree of interaction: 1 3 (additive model)
GCV 12.1    RSS 197    GRSq 0.957    RSq 0.976
> print(summary(fit1, digits = 3))
Call: earth(formula=Volume~., data=trees, trace=0, degree=2)

             coefficients
(Intercept)        27.246
h(Girth-14)         6.177
h(14-Girth)        -3.266
h(Height-72)        0.491

Selected 4 of 7 terms, and 2 of 2 predictors 
Importance: Girth, Height
Number of terms at each degree of interaction: 1 3 (additive model)
GCV 12.1    RSS 197    GRSq 0.957    RSq 0.976
> print(evimp(fit1, trim=FALSE))
       nsubsets   gcv    rss
Girth         3 100.0  100.0
Height        1  11.4   12.1
> fit2 <- update(fit1, nprune = 3, trace = 0)
> print(fit2, digits = 3)
Selected 3 of 7 terms, and 1 of 2 predictors 
Importance: Girth, Height-unused
Number of terms at each degree of interaction: 1 2 (additive model)
GCV 15.5    RSS 313    GRSq 0.944    RSq 0.961
> print(earth:::get.nterms.per.degree(fit1))

0 1 
1 3 
> print(earth:::get.nused.preds.per.subset(fit1$dirs, fit1$which.terms))
[1] 0 1
> print(variable.names(fit1))
[1] "Girth"  "Height"
> print(deviance(fit1))
[1] 197
> print(earth:::reorder.earth(fit1))
[1] 1 2 3 4
> print(predict(fit1, c(70, 12)))
     Volume
[1,]    373
> fit3 <- earth(Volume ~ ., data = trees, degree = 1, minspan = 1)
> print(fit3, digits = 4)
Selected 4 of 5 terms, and 2 of 2 predictors 
Importance: Girth, Height
Number of terms at each degree of interaction: 1 3 (additive model)
GCV 10.67    RSS 198.2    GRSq 0.9618    RSq 0.9755
> print(summary(fit3, digits = 3, style = "pmax"))
Call: earth(formula=Volume~., data=trees, degree=1, minspan=1)

Volume =
  27.1
  + 6.08 * pmax(0,  Girth -   13.8) 
  - 3.25 * pmax(0,   13.8 -  Girth) 
  +  0.6 * pmax(0, Height -     75) 

Selected 4 of 5 terms, and 2 of 2 predictors 
Importance: Girth, Height
Number of terms at each degree of interaction: 1 3 (additive model)
GCV 10.7    RSS 198    GRSq 0.962    RSq 0.976
> 
